<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>لوحة المشرف - إجابات العملاء</title>
  <style>
    body {
      font-family: 'Tajawal', sans-serif;
      background-color: #f1f1f1;
      color: #004d40;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 900px;
      margin: 50px auto;
      background-color: #fff;
      padding: 30px;
      border-radius: 12px;
      border: 2px solid #004d40;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
    }
    .company-name {
      background-color: #e6f9ec;
      padding: 15px;
      text-align: center;
      font-size: 24px;
      font-weight: bold;
      color: #006400;
      margin-bottom: 30px;
    }
    h2 {
      text-align: center;
      margin-bottom: 25px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 16px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: center;
    }
    th {
      background-color: #00796b;
      color: white;
    }
    .btn-download {
      background-color: #00796b;
      color: white;
      padding: 8px 15px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .btn-download:hover {
      background-color: #004d40;
    }
    footer {
      margin-top: 40px;
      text-align: center;
      font-size: 14px;
      color: #777;
    }
  </style>
</head>
<body>

  <div class="container">
    <div class="company-name">سرعة تملك العقار والحلول التمويلية المتكاملة</div>

    <h2>إجابات العملاء المعتمدة</h2>

    <table id="clientTable">
      <thead>
        <tr>
          <th>الاسم</th>
          <th>رقم الهوية</th>
          <th>تاريخ التوقيع</th>
          <th>الموقع</th>
          <th>الحالة</th>
          <th>تحميل</th>
        </tr>
      </thead>
      <tbody>
        <!-- يتم تعبئته تلقائيًا -->
      </tbody>
    </table>

    <footer>
      جميع الحقوق محفوظة لشركة سرعة تملك العقار
    </footer>
  </div>

  <script>
    const clients = JSON.parse(localStorage.getItem("clients") || "[]");

    function generatePDF(client) {
      const win = window.open('', '_blank');
      win.document.write(`
        <html lang="ar" dir="rtl">
        <head>
          <meta charset="UTF-8">
          <title>عقد PDF</title>
          <style>
            body { font-family: 'Tajawal', sans-serif; margin: 40px; color: #000; line-height: 2; }
            .header { text-align: center; font-size: 22px; font-weight: bold; color: #006400; margin-bottom: 20px; }
            .section { margin-bottom: 20px; }
            .bold { font-weight: bold; }
            .footer { margin-top: 40px; font-size: 13px; text-align: center; border-top: 1px dashed #999; padding-top: 10px; color: #555; }
          </style>
        </head>
        <body>
          <div class="header">سرعة تملك العقار والحلول التمويلية المتكاملة</div>

          <div class="section">تم إبرام هذا العقد بين:</div>

          <div class="section">
            الطرف الأول: <span class="bold">شركة الوساطة العقارية والتسويق</span><br>
            الطرف الثاني: <span class="bold">${client.name}</span><br>
            رقم الهوية: ${client.id}<br>
            تاريخ الميلاد: ${client.birth}<br>
            رقم الجوال: ${client.mobile}<br>
            الموقع: ${client.location}<br>
            وقت التوقيع: ${client.time}
          </div>

          <div class="section">
            <span class="bold">وقد وافق الطرف الثاني على جميع البنود التالية:</span><br><br>
            1. التمهيد جزء لا يتجزأ من العقد.<br>
            2. الطرف الأول ينهي كافة إجراءات التمويل العقاري للطرف الثاني.<br>
            3. يلتزم الطرف الثاني بدفع 2.5% من قيمة العقار + 500 ريال للطرف الأول.<br>
            4. يُعاد المبلغ إذا لم تُتم الصفقة بسبب طرف خارجي.<br>
            5. إذا انسحب الطرف الثاني، يُعد المبلغ مستحقًا للطرف الأول.<br>
            6. يتحمل الطرف الثاني مسؤولية التأخير أو المماطلة.<br>
            7. يجب عدم إخفاء معلومات مالية أو التزامات.<br>
            8. يلتزم بتحويل راتبه للبنك المحدد عند الحاجة.<br>
            9. تنتهي العلاقة بين الطرفين بعد توقيع التمويل من الجهة الممولة.<br>
            10. العناوين المعتمدة في العقد هي للتواصل الرسمي.<br>
            11. في حال النزاع، يُحال للمحكمة المختصة في مدينة الرياض.<br>
            12. تم تحرير هذا العقد إلكترونيًا ويُعد سندًا نظاميًا رسميًا.
          </div>

          <div class="section">
            التوقيع الإلكتروني للطرف الأول: نايف المطيري<br>
            التوقيع الإلكتروني للطرف الثاني: ${client.name}
          </div>

          <div class="footer">
            تم توليد هذا العقد إلكترونيًا ويُعد سندًا تنفيذيًا بموجب المادة (9) من نظام المعاملات الإلكترونية.<br>
            جميع الحقوق محفوظة لشركة سرعة تملك العقار.
          </div>
        </body>
        </html>
      `);
      win.document.close();
      win.print();
    }

    function fillTable() {
      const tbody = document.querySelector("#clientTable tbody");
      if (clients.length === 0) {
        tbody.innerHTML = `<tr><td colspan="6">لا يوجد عملاء حتى الآن</td></tr>`;
        return;
      }

      clients.forEach(client => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${client.name}</td>
          <td>${client.id}</td>
          <td>${client.time}</td>
          <td>${client.location}</td>
          <td style="color: green;">موافق ✅</td>
          <td><button class="btn-download" onclick='generatePDF(${JSON.stringify(client)})'>تحميل PDF</button></td>
        `;
        tbody.appendChild(row);
      });
    }

    fillTable();
  </script>

</body>
</html>