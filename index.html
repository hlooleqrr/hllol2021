
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>عقد إنهاء إجراءات تمويل عقاري</title>
  <style>
    body {
      font-family: 'Tajawal', sans-serif;
      background-color: #f4f6f8;
      margin: 0;
      padding: 0;
      direction: rtl;
      text-align: center;
    }
    .step {
      display: none;
      padding: 30px;
    }
    .step.active {
      display: block;
    }
    input {
      padding: 10px;
      width: 80%;
      font-size: 16px;
      margin: 10px 0;
    }
    button {
      padding: 10px 30px;
      font-size: 18px;
      margin-top: 20px;
    }
    textarea {
      width: 90%;
      height: 400px;
      margin-top: 20px;
    }
  </style>
</head>
<body>

  <!-- الخطوة 1 -->
  <div class="step active" id="step1">
    <h1>عقد إنهاء إجراءات تمويل عقاري من البنوك</h1>
    <button onclick="nextStep(2)">التالي</button>
  </div>

  <!-- الخطوة 2 -->
  <div class="step" id="step2">
    <h2>المملكة العربية السعودية</h2>
    <h3>الوساطة العقارية والتسويق</h3>
    <p>ترخيص رقم (1100042624)</p>
    <button onclick="nextStep(3)">ابدأ قراءة العقد</button>
  </div>

  <!-- الخطوة 3 -->
  <div class="step" id="step3">
    <h2>الرجاء تعبئة بيانات الطرف الثاني</h2>
    <input type="text" id="fullName" placeholder="الاسم الكامل" required>
    <input type="text" id="idNumber" placeholder="رقم السجل المدني (10 أرقام)" required>
    <button onclick="validateAndProceed()">باسم الله نبدأ</button>
  </div>

  <!-- الخطوة 4 -->
  <div class="step" id="step4">
    <h2>نص العقد</h2>
    <textarea readonly>
بسم الله الرحمن الرحيم
المملكة العربية السعودية
الوساطة العقارية والتسويق
ترخيص رقم (1100042624)

عقد اتفاقية إنهاء إجراءات تمويل

تم بموجبه التوقيع في يوم الاثنين بتاريخ: / / الموافق: / / 20م، بين كلٍ من:
1/ شركة سرعة تملك العقار، وتمثلها الأستاذ/ نايف المطيري، ويشار إليه بالطرف الأول.
2/ الطرف الثاني: (الاسم والسجل المدني يضاف آليًا)

بموجب هذا العقد يلتزم الطرف الأول بإنهاء إجراءات التمويل العقاري مقابل:
- 2.5٪ من قيمة شيك المالك.
- مبلغ 500 ريال رسوم العقد.

(باقي البنود محفوظة كما هي...)
    </textarea>
    <button onclick="submitAgreement()">موافقة</button>
    <button onclick="nextStep(1)">رفض</button>
  </div>

<script>
  function nextStep(stepNumber) {
    document.querySelectorAll('.step').forEach(div => div.classList.remove('active'));
    document.getElementById('step' + stepNumber).classList.add('active');
  }

  function validateAndProceed() {
    const name = document.getElementById("fullName").value.trim();
    const id = document.getElementById("idNumber").value.trim();

    if (name === "" || !/^\d{10}$/.test(id)) {
      alert("يرجى تعبئة الاسم ورقم السجل المدني (10 أرقام) بشكل صحيح.");
      return;
    }

    nextStep(4);
  }

  async function submitAgreement() {
    const name = document.getElementById("fullName").value.trim();
    const id = document.getElementById("idNumber").value.trim();
    const content = `تمت الموافقة على العقد من قبل:\nالاسم: ${name}\nالسجل المدني: ${id}`;

    const fileName = `contracts/contract_${id}.txt`;
    const token = "ghp_your_token_here";  // <-- استبدله لاحقاً بالتوكن الفعلي
    const repo = "hlooleqrr.github.io";
    const owner = "hlooleqrr";
    const branch = "main";

    const body = {
      message: `إضافة عقد جديد للطرف الثاني: ${name}`,
      content: btoa(unescape(encodeURIComponent(content))),
      branch: branch
    };

    fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${fileName}`, {
      method: "PUT",
      headers: {
        "Content-Type": "application/json",
        Authorization: `token ${token}`
      },
      body: JSON.stringify(body)
    }).then(res => {
      if (res.ok) alert("تم حفظ العقد بنجاح في المستودع.");
      else alert("حدث خطأ أثناء رفع العقد.");
    });
  }
</script>

</body>
</html>
