<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>بيانات إضافية</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Tajawal', sans-serif;
      background: #f9fafb;
      margin: 0;
      padding: 20px;
      color: #004d40;
    }
    .container {
      max-width: 700px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      border: 2px solid #004d40;
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }
    input, select, button {
      width: 100%;
      padding: 12px;
      margin-top: 8px;
      border-radius: 8px;
      font-size: 1rem;
    }
    input, select {
      border: 2px solid #009688;
    }
    button {
      background: #00796b;
      color: white;
      border: none;
      margin-top: 20px;
      font-weight: bold;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>البيانات الإضافية</h2>

    <label>رقم الجوال:</label>
    <input type="tel" id="phone" placeholder="مثال: 05XXXXXXXX">

    <label>تاريخ الميلاد:</label>
    <div style="display: flex; gap: 5px;">
      <select id="day"><option value="">اليوم</option></select>
      <select id="month"><option value="">الشهر</option></select>
      <select id="year"><option value="">السنة</option></select>
    </div>

    <button id="nextBtn" disabled>التالي ➔</button>
  </div>

  <script>
    const phoneInput = document.getElementById('phone');
    const daySelect = document.getElementById('day');
    const monthSelect = document.getElementById('month');
    const yearSelect = document.getElementById('year');
    const nextBtn = document.getElementById('nextBtn');

    for (let i = 1; i <= 31; i++) {
      daySelect.innerHTML += `<option value="${i}">${i}</option>`;
    }
    const monthNames = ["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"];
    for (let i = 1; i <= 12; i++) {
      monthSelect.innerHTML += `<option value="${i}">${monthNames[i-1]}</option>`;
    }
    for (let i = 1960; i <= 2010; i++) {
      yearSelect.innerHTML += `<option value="${i}">${i}</option>`;
    }

    function validate() {
      const phoneOk = /^05\d{8}$/.test(phoneInput.value.trim());
      const dayOk = daySelect.value !== "";
      const monthOk = monthSelect.value !== "";
      const yearOk = yearSelect.value !== "";
      nextBtn.disabled = !(phoneOk && dayOk && monthOk && yearOk);
    }

    phoneInput.addEventListener('input', validate);
    daySelect.addEventListener('change', validate);
    monthSelect.addEventListener('change', validate);
    yearSelect.addEventListener('change', validate);

    nextBtn.addEventListener('click', () => {
      const data1 = JSON.parse(localStorage.getItem('contract-step1') || '{}');
      const fullData = {
        ...data1,
        phone: phoneInput.value.trim(),
        birth: `${daySelect.value}/${monthSelect.value}/${yearSelect.value}`
      };
      localStorage.setItem('contract-client', JSON.stringify(fullData));
      location.href = 'contract.html';
    });

    if (localStorage.getItem("contract-locked") === "true") {
      location.href = "blocked.html";
    }
  </script>
</body>
</html>
