<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>تأكيد العقد</title>
  <style>
    body {
      font-family: 'Tajawal', sans-serif;
      background-color: #fdfdfd;
      margin: 0;
      padding: 0;
      text-align: center;
      color: #004d40;
    }
    .box {
      max-width: 700px;
      margin: 60px auto;
      background: white;
      border: 3px solid #004d40;
      border-radius: 15px;
      padding: 40px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    }
    h1 {
      font-size: 24px;
      margin-bottom: 20px;
    }
    .info {
      font-size: 16px;
      line-height: 2;
      margin-bottom: 30px;
    }
    input {
      width: 100%;
      padding: 12px;
      margin-top: 10px;
      margin-bottom: 20px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    button {
      padding: 12px 28px;
      font-size: 16px;
      background-color: #00796b;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .error {
      color: red;
      margin-top: 10px;
    }
  </style>
</head>
<body onload="loadData()">

  <div class="box">
    <h1>تأكيد نهائي قبل إبرام العقد</h1>
    <div class="info" id="summary"></div>

    <form onsubmit="return confirmSubmission();">
      <input type="text" id="nidConfirm" placeholder="أدخل رقم الهوية للتأكيد" required pattern="^[0-9]{10}$">
      <input type="text" id="agreeWord" placeholder="اكتب كلمة (موافق)" required>
      <button type="submit">إبرام العقد ✅</button>
    </form>
    <div class="error" id="errorMsg"></div>
  </div>

  <script>
    function loadData() {
      const name = localStorage.getItem("name") || "غير معروف";
      const nid = localStorage.getItem("nid") || "غير معروف";
      const mobile = localStorage.getItem("mobile") || "غير معروف";
      const birth = localStorage.getItem("birth") || "غير معروف";
      const now = new Date().toLocaleString('ar-EG');

      navigator.geolocation.getCurrentPosition(pos => {
        const lat = pos.coords.latitude.toFixed(5);
        const long = pos.coords.longitude.toFixed(5);
        document.getElementById("summary").innerHTML = `
          الاسم: ${name}<br>
          رقم الهوية: ${nid}<br>
          رقم الجوال: ${mobile}<br>
          تاريخ الميلاد: ${birth}<br>
          التاريخ والوقت الحالي: ${now}<br>
          الموقع: خط العرض ${lat} - خط الطول ${long}
        `;
      });
    }

    function confirmSubmission() {
      const enteredNid = document.getElementById("nidConfirm").value.trim();
      const requiredNid = localStorage.getItem("nid");
      const word = document.getElementById("agreeWord").value.trim();

      if (enteredNid !== requiredNid || word !== "موافق") {
        document.getElementById("errorMsg").textContent = "البيانات غير صحيحة، يرجى التحقق.";
        return false;
      }

      window.location.href = "step3.html";
      return false;
    }
  </script>

</body>
</html>